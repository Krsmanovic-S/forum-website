{% extends "base.html" %}
{% include "header.html" %}
{% block title %}Rep Talk{% endblock %}
{% block content %}
<div class="container mt-4">
  <div class="row">
    <div class="col-md-3 d-none d-md-block rounded-3" style="height: 630px; background-color: #1e1e1e; border: 1px solid #333; color: #E0E0E0; padding: 1rem;">
      {% for category in categories %}
        <div class="mb-3">
          <img src="{{ url_for('static', filename='assets/category_images/' ~ category.id ~ '.png') }}"
           alt="{{ category.name }} icon"
           style="width: 25px; height: 25px; object-fit: contain; margin-right: 5px; margin-bottom: 3px"
          >
          <a href="{{ url_for('home') if selected_category == category.name else url_for('home', category=category.name) }}"
             class="text-decoration-none text-light fw-semibold category-title">
            {{ category.name }}
          </a>
          <p class="mb-1 text-muted category-description">{{ category.description }}</p>
          {% if category.name != 'Health & Wellness' %}
          <hr style="border: 1px solid #444;">
          {% endif %}
        </div>
      {% endfor %}
    </div>

    <div class="col-12 col-md-6">
      {% for post in all_posts %}
      <div class="card mb-3 shadow-sm position-relative" style="height: 200px; background-color: #1e1e1e; border: 1px solid #333; color: #E0E0E0;">
        <div class="card-body">
          <h5 class="card-title mb-2">
            {{ post.title }}
            <span class="category-label category-{{ post.category.id }}">{{ post.category.name }}</span>
          </h5>

          <p class="card-subtitle mb-2 text-muted">
            Posted by
            <a class="card-subtitle mb-2 text-muted username-link" style="z-index: 10; position: relative;" href="{{ url_for('profile', profile_username=post.author.username) }}">
              {{ post.author.username }}</a>
          </p>

          <p class="card-text text-secondary mb-3">
            {{ post.body[:200]|striptags }}
            {% if post.body|length > 200 %} ... {% endif %}
          </p>

          <div class="d-flex justify-content-between align-items-center">
            <small class="text-muted">{{ post.date.strftime('%B %d, %Y') }}</small>
            <small class="text-muted">{{ post.comments|length }} comments</small>
          </div>

          <a href="{{ url_for('view_post', post_id=post.id) }}" class="stretched-link"></a>
        </div>
      </div>
      {% endfor %}
    </div>

    <div class="col-md-3 d-none d-md-block rounded-3">
      <div class="card mb-3 shadow-sm" style="background-color: #1e1e1e; border: 1px solid #333; color: #E0E0E0;">
        <div class="card-body">
          <h5 class="card-title mb-2">Right Sidebar</h5>
          <p class="card-text">This is right sidebar content.</p>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
{% block footer %}
{% include "footer.html" %}
{% endblock %}